@if (this.authService.isLoggedIn()) {
  <div class="alert alert-success mt-3 text-center">
    Hi <span class="fw-bold">{{ this.authService.currentUser()?.username }}</span> you are logged in!
  </div>
} @else {
  <form [formGroup]="loginForm" (ngSubmit)="onSubmit()" class="login-form">

    <!-- Username -->
    <div class="form-group position-relative">
      <p-iconfield>
        <p-inputgroup>
          <p-inputgroup-addon>
            <i class="pi pi-user"></i>
          </p-inputgroup-addon>
            <input
              type="text"
              placeholder="Username or Email"
              formControlName="identifier"
              pInputText
              class="form-control"
              id="login-username"
              autofocus
            >
        </p-inputgroup>
      </p-iconfield>

      <!-- Username validation -->
      @if (this.getFormControls['identifier'].touched && this.getFormControls['identifier'].invalid) {
        <small class="error-message">
          @if (this.getFormControls['identifier'].errors?.['required']) {
            <span>Username or email is required.</span>
          }
        </small>
      }
    </div>

    <!-- Password -->
    <!-- [feedback]="false" removes pw strength indicator -->
    <div class="form-group login-password position-relative">
      <p-iconfield>
        <p-inputgroup>
          <p-inputgroup-addon>
            <i class="pi pi-lock"></i>
          </p-inputgroup-addon>
            <p-password
              [toggleMask]="true"
              [feedback]="false"
              [showClear]="hasPasswordValue()"
              placeholder="Password"
              formControlName="password"
              id="login-password"
              fluid
            />
        </p-inputgroup>
      </p-iconfield>

      <!-- Password validation -->
      @if (this.getFormControls['password'].touched && this.getFormControls['password'].invalid) {
        <small class="error-message">
          @if (this.getFormControls['password'].errors?.['required']) {
            <span>Password is required.</span>
          }
        </small>
      }
    </div>

    <div class="form-group">
      <div class="checkbox-wrapper">
        <p-checkbox formControlName="rememberMe" [binary]="true" inputId="remember-me"/>
        <label for="remember-me">Remember me</label>
      </div>
    </div>

    @if (this.loginFailed) {
      <div class="login-failed">
        <small>Username and password do not match.</small>
      </div>
    }

    <!-- Submit -->
    <div class="form-group d-flex justify-content-center">
      <button class="btn btn-purple btn-primary mb-3" id="login-button" type="submit">
        Login
      </button>
    </div>
  </form>
}
